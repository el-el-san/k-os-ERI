# kamuiosã«ãŠã‘ã‚‹æ©Ÿèƒ½è¿½åŠ ã¨ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã®ã¾ã¨ã‚

## 1. ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ç›®çš„

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ã€`org-kamuios`ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ãƒ™ãƒ¼ã‚¹ã¨ã—ã¦`kamuios`ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§è¡Œã‚ã‚ŒãŸæ©Ÿèƒ½è¿½åŠ ã‚„ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã®è©³ç´°ã‚’ã¾ã¨ã‚ãŸã‚‚ã®ã§ã™ã€‚

ä¸»ãªç›®çš„ã¯ã€å°†æ¥`org-kamuios`ã®æ–°ã—ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒãƒªãƒªãƒ¼ã‚¹ã•ã‚ŒãŸéš›ã«ã€ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‚ç…§ã™ã‚‹ã“ã¨ã§ã€åŒæ§˜ã®å¤‰æ›´ã‚’åŠ¹ç‡çš„ã«é©ç”¨ã—ã€`kamuios`ã‚’ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ãŸã‚ã®æŠ€è¡“çš„ãªæ‰‹é †æ›¸ã¨ã—ã¦åˆ©ç”¨ã™ã‚‹ã“ã¨ã§ã™ã€‚

å„ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã¯ã€ãƒ•ã‚¡ã‚¤ãƒ«ã®å¤‰æ›´ç‚¹ã€è¿½åŠ ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã€å‰Šé™¤ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã«ã¤ã„ã¦ã€å¤‰æ›´å†…å®¹ã®è©³ç´°ãªèª¬æ˜ã¨ã€å†ç¾ã«å¿…è¦ãªã‚³ãƒ¼ãƒ‰ã®å·®åˆ†ï¼ˆdiffï¼‰ã¾ãŸã¯å®Œå…¨ãªã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’è¨˜è¼‰ã—ã¾ã™ã€‚

## 2. å¤‰æ›´ç‚¹è©³ç´°

### å‰Šé™¤ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«

ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã¯ã€`kamuios`ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§å‰Šé™¤ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸€è¦§ã‚’è¨˜è¼‰ã—ã¾ã™ã€‚

- **ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹**: `index-original.html`
  - **èª¬æ˜**: ä¸è¦ã«ãªã£ãŸHTMLãƒ•ã‚¡ã‚¤ãƒ«ãŒå‰Šé™¤ã•ã‚Œã¾ã—ãŸã€‚

### æ–°è¦è¿½åŠ ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«

ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã¯ã€`kamuios`ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§æ–°ãŸã«è¿½åŠ ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸€è¦§ã‚’è¨˜è¼‰ã—ã¾ã™ã€‚

- **ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹**: `data/saas/direct-drawing-generator.yaml`
  - **èª¬æ˜**: æ–°æ©Ÿèƒ½ã€ŒDirect Drawing Generatorã€ã®SaaSå®šç¾©ãƒ•ã‚¡ã‚¤ãƒ«ã§ã™ã€‚

- **ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹**: `data/saas/story-gen.yaml`
  - **èª¬æ˜**: æ–°æ©Ÿèƒ½ã€ŒStory Genã€ã®SaaSå®šç¾©ãƒ•ã‚¡ã‚¤ãƒ«ã§ã™ã€‚

- **ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹**: `static/js/gallery-manager.js`
  - **èª¬æ˜**: ãƒ¡ãƒ‡ã‚£ã‚¢ã‚®ãƒ£ãƒ©ãƒªãƒ¼ã®é¸æŠçŠ¶æ…‹ã‚’ç®¡ç†ã™ã‚‹ãŸã‚ã®JavaScriptãƒ•ã‚¡ã‚¤ãƒ«ã§ã™ã€‚

- **ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹**: `static/js/mcp-client.js`
  - **èª¬æ˜**: MCP (Model Context Protocol) ã‚µãƒ¼ãƒãƒ¼ã¨é€šä¿¡ã™ã‚‹ãŸã‚ã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™ã€‚

- **ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹**: `static/js/story-gen-save-load.js`
  - **èª¬æ˜**: Story Genã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ä¿å­˜ãƒ»èª­ã¿è¾¼ã¿æ©Ÿèƒ½ã«é–¢ã™ã‚‹JavaScriptãƒ•ã‚¡ã‚¤ãƒ«ã§ã™ã€‚


### å¤‰æ›´ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«

ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã¯ã€`org-kamuios`ã‹ã‚‰`kamuios`ã¸ã®ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã§å¤‰æ›´ãŒåŠ ãˆã‚‰ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã«ã¤ã„ã¦è¨˜è¼‰ã—ã¾ã™ã€‚

- **ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹**: `backend/server.js`
  - **èª¬æ˜**: Story Genã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ä¿å­˜ãƒ»èª­ã¿è¾¼ã¿APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ (`/api/story-gen/save`, `/api/story-gen/load/:saveId`, `/api/story-gen/list`) ãŒè¿½åŠ ã•ã‚Œã¾ã—ãŸã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒä½œæˆã—ãŸã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚’ã‚µãƒ¼ãƒãƒ¼ã«ä¿å­˜ã—ã€å¾Œã‹ã‚‰èª­ã¿è¾¼ã‚€ã“ã¨ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚
  - **å·®åˆ†**:
```diff
--- org-kamuios/backend/server.js	2025-09-23 10:32:52.547629827 +0000
+++ kamuios/backend/server.js	2025-09-23 10:32:50.259629853 +0000
@@ -2841,7 +2841,7 @@
             if (mcpPath && fs.existsSync(mcpPath)) {
                 const data = JSON.parse(fs.readFileSync(mcpPath, 'utf8'));
                 const raw = data.mcpServers || data.servers || {};
-                const baseUrl = process.env.MCP_BASE_URL;
+                const baseUrl = process.env.MCP_BASE_URL;

                 for (const [name, cfg] of Object.entries(raw)) {
                     if (!cfg || typeof cfg !== 'object') continue;

```

- **ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹**: `data/saas/dynamic-media-gallery.yaml`
  - **èª¬æ˜**: å‹•çš„ãƒ¡ãƒ‡ã‚£ã‚¢ã‚®ãƒ£ãƒ©ãƒªãƒ¼ã®UIã¨æ©Ÿèƒ½ãŒæ‹¡å¼µã•ã‚Œã¾ã—ãŸã€‚
  - **å·®åˆ†**:
```diff
--- org-kamuios/data/saas/dynamic-media-gallery.yaml	2025-09-23 10:32:52.559629827 +0000
+++ kamuios/data/saas/dynamic-media-gallery.yaml	2025-09-23 10:32:50.279629853 +0000
@@ -1,14 +1,36 @@
 - id: dynamic-media-gallery
   category: 1
   category_name: ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
-  title: ãƒ€ã‚¤ãƒŠãƒŸãƒƒã‚¯ãƒ¡ãƒ‡ã‚£ã‚¢ã‚®ãƒ£ãƒ©ãƒªãƒ¼
+  title: Dynamic Media Gallery
   content: ""
   custom_html: |
-    <div style="background: #0f0f0f; border-radius: 12px; overflow: hidden; margin: 20px 0; min-height: 800px; position: relative;">
+    <div class="dynamic-media-embed" style="background: #0f0f0f; border-radius: 12px; overflow: hidden; margin: 20px 0; position: relative; height: clamp(560px, 80vh, 1000px); width: 100%; max-width: 100%;">
       <!-- ã‚®ãƒ£ãƒ©ãƒªãƒ¼åŸ‹ã‚è¾¼ã¿ -->
-      <iframe
-        src="/data/media-gallery/index.html"
-        style="width: 100%; height: 800px; border: none; display: block; position: absolute; top: 0; left: 0;"
+      <iframe
+        src="/data/media-gallery/index.html"
+        style="width: 100%; height: 100%; border: none; display: block; position: absolute; top: 0; left: 0;"
         frameborder="0">
       </iframe>
     </div>
+    <style>
+      /* Ensure the embed never causes horizontal overflow */
+      #dynamic-media-gallery .dynamic-media-embed { max-width: 100%; width: 100%; overflow: hidden; }
+      #dynamic-media-gallery .dynamic-media-embed iframe { width: 100%; height: 100%; display: block; }
+      @media (min-width: 1024px) {
+        #dynamic-media-gallery .dynamic-media-embed { height: clamp(640px, 85vh, 1100px); }
+      }
+      @media (max-width: 768px) {
+        #dynamic-media-gallery .dynamic-media-embed {
+          margin: 10px 0 !important;
+          height: 82vh !important;
+          min-height: 360px !important;
+        }
+      }
+      @media (max-width: 480px) {
+        #dynamic-media-gallery .dynamic-media-embed {
+          margin: 5px 0 !important;
+          height: 85vh !important;
+          min-height: 320px !important;
+        }
+      }
+    </style>
```

- **ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹**: `data/sections.yaml`
  - **èª¬æ˜**: æ–°ã—ã„SaaSã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆDirect Drawing Generator, Story Genï¼‰ãŒã‚µã‚¤ãƒ‰ãƒãƒ¼ã«è¿½åŠ ã•ã‚Œã¾ã—ãŸã€‚
  - **å·®åˆ†**:
```diff
--- org-kamuios/data/sections.yaml	2025-09-23 10:32:52.571629827 +0000
+++ kamuios/data/sections.yaml	2025-09-23 10:32:50.295629853 +0000
@@ -214,6 +214,38 @@
             â€¢ é™æ­¢ç”»/å‹•ç”»å¯¾å¿œ
           </div>
         </a>
+
+        <a href="#saas-direct-drawing" class="saas-app-card" onclick="showSaasApp('direct-drawing'); return false;">
+          <video src="/videos/dashboard_card.mp4" alt="Direct Drawing" style="width: 100%; height: 180px; object-fit: cover; border-radius: 8px; margin-bottom: 12px;" autoplay loop muted playsinline></video>
+          <div class="saas-app-title">
+            4. Direct Drawing
+            <span class="saas-app-arrow">â†’</span>
+          </div>
+          <div class="saas-app-description">
+            AIã§é«˜å“è³ªãªç”»åƒã‚’ç”Ÿæˆã™ã‚‹ãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆãƒ‰ãƒ­ãƒ¼ã‚¤ãƒ³ã‚°ãƒ„ãƒ¼ãƒ«
+          </div>
+          <div class="saas-app-features">
+            â€¢ ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æç”»<br>
+            â€¢ å¤šå½©ãªãƒ–ãƒ©ã‚·ãƒ„ãƒ¼ãƒ«<br>
+            â€¢ AIã«ã‚ˆã‚‹è£œæ­£ãƒ»ç”Ÿæˆ
+          </div>
+        </a>
+
+        <a href="#saas-story-gen" class="saas-app-card" onclick="showSaasApp('story-gen'); return false;">
+          <video src="/videos/storyboard_viewer_card.mp4" alt="Story Gen" style="width: 100%; height: 180px; object-fit: cover; border-radius: 8px; margin-bottom: 12px;" autoplay loop muted playsinline></video>
+          <div class="saas-app-title">
+            5. Story Gen
+            <span class="saas-app-arrow">â†’</span>
+          </div>
+          <div class="saas-app-description">
+            ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‹ã‚‰ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã¨ç”»åƒã‚’ç”Ÿæˆã™ã‚‹AIã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼
+          </div>
+          <div class="saas-app-features">
+            â€¢ ãƒ†ã‚­ã‚¹ãƒˆã‹ã‚‰ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ç”Ÿæˆ<br>
+            â€¢ ã‚·ãƒ¼ãƒ³ã”ã¨ã®ç”»åƒç”Ÿæˆ<br>
+            â€¢ ãƒ“ãƒ‡ã‚ªã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
+          </div>
+        </a>
       </div>
     </div>

```

- **ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹**: `env.sample`
  - **èª¬æ˜**: MCPã‚µãƒ¼ãƒãƒ¼ã®ãƒ™ãƒ¼ã‚¹URLã‚„ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½ã«é–¢ã™ã‚‹ç’°å¢ƒå¤‰æ•°ãŒè¿½åŠ ã•ã‚Œã¾ã—ãŸã€‚
  - **å·®åˆ†**:
```diff
--- org-kamuios/env.sample	2025-09-23 10:32:52.571629827 +0000
+++ kamuios/env.sample	2025-09-23 10:32:50.299629853 +0000
@@ -35,6 +35,9 @@
 # MCP (Model Context Protocol) è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹
 CLAUDE_MCP_CONFIG_PATH=/path/to/mcp-kamui-code.json

+# MCPã‚µãƒ¼ãƒãƒ¼ã®ãƒ™ãƒ¼ã‚¹URL (backend/server.jsã§ä½¿ç”¨)
+MCP_BASE_URL=https://base-url
+
 # ------------------------------------------------------------
 # X (Twitter) APIè¨­å®š
 # ------------------------------------------------------------
@@ -69,6 +72,12 @@
 # API_BASE_URL=http://localhost:3001
 API_BASE_URL=http://localhost:8888

+#image upload : optional
+UPLOAD_URL=https://your-url
+
+# Bearer token for the uploader (Authorization: Bearer <token>)
+UPLOAD_API_KEY=api-key
+
 # ------------------------------------------------------------
 # æ³¨æ„äº‹é …
 # ------------------------------------------------------------
```

- **ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹**: `package.json`
  - **èª¬æ˜**: æ–°æ©Ÿèƒ½ã§å¿…è¦ã¨ãªã‚‹ `fs-extra` ã¨ `js-yaml` ã®ä¾å­˜é–¢ä¿‚ãŒè¿½åŠ ã•ã‚Œã¾ã—ãŸã€‚
  - **å·®åˆ†**:
```diff
--- org-kamuios/package.json	2025-09-23 10:32:52.579629827 +0000
+++ kamuios/package.json	2025-09-23 10:32:50.303629853 +0000
@@ -12,6 +12,8 @@
   "license": "ISC",
   "dependencies": {
     "cors": "^2.8.5",
-    "express": "^5.1.0"
+    "express": "^5.1.0",
+    "fs-extra": "^11.2.0",
+    "js-yaml": "^4.1.0"
   }
 }
```

- **ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹**: `server.js`
  - **èª¬æ˜**: ã‚µãƒ¼ãƒãƒ¼èµ·å‹•ã‚¹ã‚¯ãƒªãƒ—ãƒˆã«ã€`backend/server.js` ã‚’ `node` ã§å®Ÿè¡Œã™ã‚‹å‡¦ç†ãŒè¿½åŠ ã•ã‚Œã¾ã—ãŸã€‚
  - **å·®åˆ†**:
```diff
--- org-kamuios/server.js	2025-09-23 10:32:52.583629827 +0000
+++ kamuios/server.js	2025-09-23 10:32:50.307629852 +0000
@@ -1,4 +1,4 @@
-// server.js
+
 const express = require('express');
 const { createProxyMiddleware } = require('http-proxy-middleware');
 const { exec } = require('child_process');
@@ -10,10 +10,19 @@
 const API_BASE_URL = process.env.API_BASE_URL;
 const UPLOAD_URL = process.env.UPLOAD_URL;
 const UPLOAD_API_KEY = process.env.UPLOAD_API_KEY;
-
 const app = express();
 const port = 8888;

+let nodeProcess = null;
+
+function startNodeServer() {
+  console.log('Starting Node.js server...');
+  nodeProcess = exec('node backend/server.js');
+
+  nodeProcess.stdout.on('data', (data) => console.log(`Node.js stdout: ${data}`));
+  nodeProcess.stderr.on('data', (data) => console.error(`Node.js stderr: ${data}`));
+  nodeProcess.on('close', (code) => console.log(`Node.js server exited with code ${code}`));
+}

 app.use(express.static('public'));

@@ -51,6 +60,7 @@
   });
 }

+
 app.listen(port, () => {
   console.log(`Server listening at http://localhost:${port}`);
   console.log('Starting Hugo server...');
@@ -62,4 +72,11 @@
   hugo.stderr.on('data', (data) => {
     console.error(`Hugo stderr: ${data}`);
   });
+
+  startNodeServer();
 });
+
+process.on('exit', () => {
+  if (hugo) hugo.kill();
+  if (nodeProcess) nodeProcess.kill();
+});
```

- **ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹**: `start_all.sh`
  - **èª¬æ˜**: èµ·å‹•ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒå¤§å¹…ã«æ”¹è‰¯ã•ã‚Œã€`screen` ã‚’ä½¿ç”¨ã—ãŸãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰å®Ÿè¡Œã€ã‚¯ãƒ­ã‚¹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ å¯¾å¿œã®ãƒ–ãƒ©ã‚¦ã‚¶è‡ªå‹•èµ·å‹•æ©Ÿèƒ½ã€ç’°å¢ƒå¤‰æ•°ã®è‡ªå‹•è¨­å®šã€ä¾å­˜é–¢ä¿‚ã®è‡ªå‹•ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãªã©ã®æ©Ÿèƒ½ãŒè¿½åŠ ã•ã‚Œã¾ã—ãŸã€‚
  - **å·®åˆ†**:
```diff
--- org-kamuios/start_all.sh	2025-09-23 10:32:54.551629805 +0000
+++ kamuios/start_all.sh	2025-09-23 10:32:50.383629852 +0000
@@ -26,6 +26,49 @@
     printf "\033[1;33m[WARNING]\033[0m %s\n" "$1"
 }

+# ãƒ–ãƒ©ã‚¦ã‚¶ã‚’è‡ªå‹•èµ·å‹•ã™ã‚‹ï¼ˆTermuxç­‰ã®ç’°å¢ƒã«ã‚‚å¯¾å¿œï¼‰
+function open_browser() {
+    local url="$1"
+
+    if [ -z "$url" ]; then
+        log_warn "No URL provided to open_browser."
+        return 1
+    fi
+
+    if command -v termux-open-url >/dev/null 2>&1; then
+        log_info "Opening $url via termux-open-url..."
+        termux-open-url "$url" >/dev/null 2>&1 &
+        return 0
+    fi
+
+    if command -v xdg-open >/dev/null 2>&1; then
+        log_info "Opening $url via xdg-open..."
+        xdg-open "$url" >/dev/null 2>&1 &
+        return 0
+    fi
+
+    if command -v open >/dev/null 2>&1; then
+        log_info "Opening $url via open..."
+        open "$url" >/dev/null 2>&1 &
+        return 0
+    fi
+
+    if command -v wslview >/dev/null 2>&1; then
+        log_info "Opening $url via wslview..."
+        wslview "$url" >/dev/null 2>&1 &
+        return 0
+    fi
+
+    if [ "${OS:-}" = "Windows_NT" ]; then
+        log_info "Opening $url via cmd.exe start..."
+        cmd.exe /C start "" "$url" >/dev/null 2>&1
+        return 0
+    fi
+
+    log_warn "Automatic browser launch not supported. Please open $url manually."
+    return 1
+}
+
 # PIDãƒ•ã‚¡ã‚¤ãƒ«ã®è¨­å®š
 PIDS_DIR="$SCRIPT_DIR/.pids"
 mkdir -p "$PIDS_DIR"
@@ -38,26 +81,16 @@

 # æ—¢å­˜ã®ãƒ—ãƒ­ã‚»ã‚¹ã‚’åœæ­¢ã™ã‚‹é–¢æ•°
 function stop_all() {
-    log_info "Stopping all services..."
-
-    # Node.js server
-    if [ -f "$PIDS_DIR/node_server.pid" ]; then
-        PID=$(cat "$PIDS_DIR/node_server.pid")
-        if kill -0 $PID 2>/dev/null; then
-            kill $PID
-            log_info "Stopped Node.js server (PID: $PID)"
-        fi
-        rm -f "$PIDS_DIR/node_server.pid"
-    fi
-
-    # Hugo server
-    if [ -f "$PIDS_DIR/hugo_server.pid" ]; then
-        PID=$(cat "$PIDS_DIR/hugo_server.pid")
-        if kill -0 $PID 2>/dev/null; then
-            kill $PID
-            log_info "Stopped Hugo server (PID: $PID)"
-        fi
-        rm -f "$PIDS_DIR/hugo_server.pid"
+    if command -v screen >/dev/null 2>&1; then
+        log_info "Stopping all screen sessions..."
+        if screen -list | grep -q "kamui_backend"; then screen -X -S kamui_backend quit; log_info "Stopped screen session: kamui_backend"; fi
+        if screen -list | grep -q "kamui_main"; then screen -X -S kamui_main quit; log_info "Stopped screen session: kamui_main"; fi
+        if screen -list | grep -q "kamui_hugo"; then screen -X -S kamui_hugo quit; log_info "Stopped screen session: kamui_hugo"; fi
+    else
+        log_info "Stopping all services using PID files..."
+        if [ -f "$PIDS_DIR/node_server.pid" ]; then PID=$(cat "$PIDS_DIR/node_server.pid"); if kill -0 $PID 2>/dev/null; then kill $PID; log_info "Stopped Node.js server (PID: $PID)"; fi; rm -f "$PIDS_DIR/node_server.pid"; fi
+        if [ -f "$PIDS_DIR/main_server.pid" ]; then PID=$(cat "$PIDS_DIR/main_server.pid"); if kill -0 $PID 2>/dev/null; then kill $PID; log_info "Stopped Node.js main server (PID: $PID)"; fi; rm -f "$PIDS_DIR/main_server.pid"; fi
+        if [ -f "$PIDS_DIR/hugo_server.pid" ]; then PID=$(cat "$PIDS_DIR/hugo_server.pid"); if kill -0 $PID 2>/dev/null; then kill $PID; log_info "Stopped Hugo server (PID: $PID)"; fi; rm -f "$PIDS_DIR/hugo_server.pid"; fi
     fi
 }

@@ -91,99 +124,125 @@
     exit 1
 fi

+if [ -z "$MCP_BASE_URL" ]; then
+    log_error "MCP_BASE_URL must be set in .env file!"
+    exit 1
+fi
+
 # ç’°å¢ƒå¤‰æ•°ã®ç¢ºèªï¼ˆãƒ‡ãƒãƒƒã‚°ç”¨ï¼‰
+LOG_INFO_MCP_PATH="(env override)"
+if [ -n "$CLAUDE_MCP_CONFIG_PATH" ]; then
+    MCP_CONFIG_PATH="$CLAUDE_MCP_CONFIG_PATH"
+else
+    MCP_CONFIG_PATH="$SCRIPT_DIR/mcp/config.json"
+    export CLAUDE_MCP_CONFIG_PATH="$MCP_CONFIG_PATH"
+    LOG_INFO_MCP_PATH="(auto)"
+fi
+
 log_info "Environment variables loaded:"
 log_info "  ANTHROPIC_API_KEY: ${ANTHROPIC_API_KEY:0:20}...${ANTHROPIC_API_KEY: -4}"
-log_info "  CLAUDE_MCP_CONFIG_PATH: $CLAUDE_MCP_CONFIG_PATH"
+log_info "  CLAUDE_MCP_CONFIG_PATH: $CLAUDE_MCP_CONFIG_PATH $LOG_INFO_MCP_PATH"
 log_info "  CLAUDE_SKIP_PERMISSIONS: $CLAUDE_SKIP_PERMISSIONS"
 log_info "  CLAUDE_DEBUG: $CLAUDE_DEBUG"

-if [ -z "$CLAUDE_MCP_CONFIG_PATH" ]; then
-    log_error "CLAUDE_MCP_CONFIG_PATH must be set in .env file!"
-    exit 1
-fi
-
 if [ ! -f "$CLAUDE_MCP_CONFIG_PATH" ]; then
     log_error "MCP config file not found at: $CLAUDE_MCP_CONFIG_PATH"
     exit 1
 fi

+MCP_STATIC_DIR="$SCRIPT_DIR/static/mcp"
+if [ -f "$CLAUDE_MCP_CONFIG_PATH" ]; then
+    mkdir -p "$MCP_STATIC_DIR"
+    if ! cp "$CLAUDE_MCP_CONFIG_PATH" "$MCP_STATIC_DIR/config.json"; then
+        log_warn "Failed to copy MCP config into static directory"
+    fi
+fi
+
 # ãƒ­ã‚°ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ä½œæˆ
 LOGS_DIR="$SCRIPT_DIR/logs"
 mkdir -p "$LOGS_DIR"
+touch "$LOGS_DIR/node_server.log" "$LOGS_DIR/main_server.log" "$LOGS_DIR/hugo_server.log"

-# Hugoã®ç”Ÿæˆã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ã‚¯ãƒªã‚¢ï¼ˆå¤ã„main.jsç­‰ãŒé…ä¿¡ã•ã‚Œã‚‹ã®ã‚’é˜²ãï¼‰
-GEN_DIR="$SCRIPT_DIR/resources/_gen"
-if [ -d "$GEN_DIR" ]; then
-    log_info "Clearing Hugo generated assets cache..."
-    rm -rf "$GEN_DIR"
+# Node.jsä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãƒã‚§ãƒƒã‚¯ï¼ˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç›´ä¸‹ï¼‰
+if [ -f "$SCRIPT_DIR/package.json" ] && [ ! -d "$SCRIPT_DIR/node_modules" ]; then
+    log_info "Installing Node.js dependencies (root)..."
+    if ! npm install --no-progress --prefer-offline &> "$LOGS_DIR/npm_install_root.log"; then
+        log_error "npm install failed. See logs/npm_install_root.log"
+        exit 1
+    fi
+    log_success "Root dependencies installed."
 fi

 # 1. Node.js backend server ã®èµ·å‹•
-log_info "Starting Node.js backend server on port ${PORT:-7777}..."
-cd "$SCRIPT_DIR/backend"
-nohup node server.js > "$LOGS_DIR/node_server.log" 2>&1 &
-NODE_PID=$!
-echo $NODE_PID > "$PIDS_DIR/node_server.pid"
+if command -v screen >/dev/null 2>&1; then
+    log_info "Starting Node.js backend server in a screen session 'kamui_backend'..."
+    screen -S kamui_backend -dm bash -c "cd '$SCRIPT_DIR/backend' && node server.js > '$LOGS_DIR/node_server.log' 2>&1"
+else
+    log_info "Starting Node.js backend server on port ${PORT:-7777}..."
+    cd "$SCRIPT_DIR/backend"
+    nohup node server.js > "$LOGS_DIR/node_server.log" 2>&1 &
+    NODE_PID=$!
+    mkdir -p "$PIDS_DIR"
+    echo $NODE_PID > "$PIDS_DIR/node_server.pid"
+fi
 sleep 2

-# Node.jsã‚µãƒ¼ãƒãƒ¼ã®èµ·å‹•ç¢ºèª
-if kill -0 $NODE_PID 2>/dev/null; then
-    log_success "Node.js server started (PID: $NODE_PID)"
+# 2. Node.js main server (upload/expose proxy) ã®èµ·å‹•
+if command -v screen >/dev/null 2>&1; then
+    log_info "Starting Node.js main server in a screen session 'kamui_main'..."
+    screen -S kamui_main -dm bash -c "cd '$SCRIPT_DIR' && node server.js > '$LOGS_DIR/main_server.log' 2>&1"
 else
-    log_error "Failed to start Node.js server. Check logs/node_server.log for details."
-    exit 1
+    cd "$SCRIPT_DIR"
+    log_info "Starting Node.js main server on port 3001..."
+    nohup node server.js > "$LOGS_DIR/main_server.log" 2>&1 &
+    MAIN_PID=$!
+    mkdir -p "$PIDS_DIR"
+    echo $MAIN_PID > "$PIDS_DIR/main_server.pid"
 fi
+sleep 2

-# 2. Hugo development server ã®èµ·å‹•
-log_info "Starting Hugo development server on port 1313..."
-cd "$SCRIPT_DIR"
-nohup hugo server -D -p 1313 > "$LOGS_DIR/hugo_server.log" 2>&1 &
-HUGO_PID=$!
-echo $HUGO_PID > "$PIDS_DIR/hugo_server.pid"
-sleep 3
-
-# Hugoã‚µãƒ¼ãƒãƒ¼ã®èµ·å‹•ç¢ºèª
-if kill -0 $HUGO_PID 2>/dev/null; then
-    log_success "Hugo server started (PID: $HUGO_PID)"
+# 3. Hugo development server ã®èµ·å‹•
+if command -v screen >/dev/null 2>&1; then
+    log_info "Starting Hugo development server in a screen session 'kamui_hugo'..."
+    screen -S kamui_hugo -dm bash -c "cd '$SCRIPT_DIR' && hugo server -D -p 1313 > '$LOGS_DIR/hugo_server.log' 2>&1"
 else
-    log_error "Failed to start Hugo server. Check logs/hugo_server.log for details."
-    exit 1
+    log_info "Starting Hugo development server on port 1313..."
+    cd "$SCRIPT_DIR"
+    nohup hugo server -D -p 1313 > "$LOGS_DIR/hugo_server.log" 2>&1 &
+    HUGO_PID=$!
+    mkdir -p "$PIDS_DIR"
+    echo $HUGO_PID > "$PIDS_DIR/hugo_server.pid"
 fi
+sleep 3

 # ã‚µãƒ¼ãƒ“ã‚¹æƒ…å ±ã®è¡¨ç¤º
 printf "\n"
-log_success "All services started successfully!"
+log_success "All services started!"
 printf "\n"
 printf "Service URLs:\n"
 printf "  - Kamui OS (Hugo):     http://localhost:1313/\n"
 printf "  - Node.js API:         http://localhost:%s/\n" "${PORT:-7777}"
-printf "\n"
-printf "Log files:\n"
-printf "  - Node.js:    logs/node_server.log\n"
-printf "  - Hugo:       logs/hugo_server.log\n"
+printf "  - Upload API Proxy:    http://localhost:3001/\n"
 printf "\n"
 printf "To stop all services, run: ./start_all.sh stop\n"
-printf "Press Ctrl+C to stop all services and exit.\n"
-printf "\n"
+if command -v screen >/dev/null 2>&1; then
+    printf "To view logs, attach to screen sessions (e.g., screen -r kamui_hugo).\n"
+else
+    printf "Log files are in the 'logs' directory.\n"
+fi
+printf "Press Ctrl+C to stop this script (if tailing logs).\n"

-# ãƒ–ãƒ©ã‚¦ã‚¶ã‚’è‡ªå‹•ã§é–‹ã
-log_info "Opening browser..."
-if [[ "$OSTYPE" == "darwin"* ]]; then
-    # macOS
-    open "http://localhost:1313/"
-elif [[ "$OSTYPE" == "linux-gnu"* ]]; then
-    # Linux
-    if command -v xdg-open > /dev/null; then
-        xdg-open "http://localhost:1313/"
-    elif command -v gnome-open > /dev/null; then
-        gnome-open "http://localhost:1313/"
-    fi
-elif [[ "$OSTYPE" == "msys" ]] || [[ "$OSTYPE" == "cygwin" ]] || [[ "$OSTYPE" == "win32" ]]; then
-    # Windows
-    start "http://localhost:1313/"
-fi
-
-# ãƒ­ã‚°ã‚’tailã—ã¦è¡¨ç¤ºï¼ˆã™ã¹ã¦ã®ã‚µãƒ¼ãƒ“ã‚¹ã®ãƒ­ã‚°ã‚’ç›£è¦–ï¼‰
-log_info "Monitoring logs (press Ctrl+C to stop all services)..."
-tail -f "$LOGS_DIR/node_server.log" "$LOGS_DIR/hugo_server.log"
+# è‡ªå‹•ã§ãƒ–ãƒ©ã‚¦ã‚¶ã‚’èµ·å‹•
+KAMUI_URL="http://localhost:1313/"
+if [ "${SKIP_AUTO_BROWSER:-0}" != "1" ]; then
+    log_info "Attempting to launch browser for $KAMUI_URL"
+    if open_browser "$KAMUI_URL"; then
+        log_success "Requested browser launch for $KAMUI_URL"
+    else
+        log_warn "Could not open browser automatically. Access $KAMUI_URL manually."
+    fi
+else
+    log_info "SKIP_AUTO_BROWSER=1 ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ãŸã‚ãƒ–ãƒ©ã‚¦ã‚¶èµ·å‹•ã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ã¾ã—ãŸã€‚"
+fi
+printf "\n"
+log_info "Startup script finished. Services are running in the background."
```

### å¤‰æ›´: `static/data/media-gallery/index.html`

```diff
--- org-kamuios/static/data/media-gallery/index.html	2025-09-23 10:32:54.555629805 +0000
+++ kamuios/static/data/media-gallery/index.html	2025-09-23 10:32:50.391629852 +0000
@@ -17,7 +17,8 @@
             color: #ffffff;
             display: flex;
             height: 100vh;
-            overflow: hidden;
+            overflow-x: hidden;
+            overflow-y: auto;
         }

         /* ã‚µã‚¤ãƒ‰ãƒãƒ¼ */
@@ -178,6 +179,7 @@
             padding: 15px 20px;
             background: #0f0f0f;
             border-bottom: 1px solid #2a2a2a;
+            flex-wrap: wrap;
         }

         .search-bar {
@@ -230,19 +232,17 @@
         .gallery-container {
             flex: 1;
             overflow-y: auto;
+            overflow-x: hidden;
             padding: 20px;
         }

         .media-grid {
             display: grid;
-            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
-            gap: 15px;
+            grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
+            gap: 12px;
         }

-        .media-grid.list-view {
-            grid-template-columns: 1fr;
-            gap: 8px;
-        }
+        .media-grid.list-view { grid-template-columns: 1fr !important; gap: 10px; width: 100%; }

         .media-item {
             background: #0f0f0f;
@@ -263,11 +263,12 @@
             align-items: center;
             padding: 10px;
             height: 60px;
+            width: 100%;
         }

         .media-thumbnail {
             width: 100%;
-            height: 150px;
+            height: 200px;
             object-fit: cover;
             background: #1a1a1a;
         }
@@ -642,6 +643,219 @@
             background: #4a4a4a;
         }

+        /* iframeå†…ã§ã®è¡¨ç¤ºæœ€é©åŒ– */
+        /* Avoid horizontal scroll inside iframe; keep vertical scroll in gallery area */
+        .gallery-container { min-height: calc(100vh - 120px); }
+
+        /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³ */
+        @media (max-width: 768px) {
+            body {
+                flex-direction: column;
+                height: auto;
+                min-height: 100vh;
+            }
+
+            .sidebar {
+                position: fixed;
+                left: 0;
+                top: 0;
+                width: min(82vw, 320px);
+                height: 100%;
+                transform: translateX(-100%);
+                transition: transform 0.3s ease;
+                z-index: 1000;
+                box-shadow: 4px 0 20px rgba(0, 0, 0, 0.5);
+            }
+
+            .sidebar.open {
+                transform: translateX(0);
+            }
+
+            .sidebar-backdrop {
+                position: fixed;
+                inset: 0;
+                background: rgba(0, 0, 0, 0.5);
+                z-index: 900;
+                display: none;
+            }
+
+            .sidebar-backdrop.show {
+                display: block;
+            }
+
+            .main-content { width: 100%; overflow-x: hidden; }
+
+            .header-bar {
+                padding: 12px 16px;
+                gap: 8px;
+            }
+
+            .header-bar::before {
+                content: "â˜°";
+                font-size: 18px;
+                color: #fff;
+                cursor: pointer;
+                padding: 8px;
+                border-radius: 4px;
+                background: #2a2a2a;
+                margin-right: 8px;
+            }
+
+            .search-bar {
+                max-width: none;
+                flex: 1;
+                padding: 6px 12px;
+                font-size: 14px;
+            }
+
+            .view-options {
+                gap: 6px;
+            }
+
+            .view-btn {
+                padding: 6px 8px;
+                font-size: 12px;
+            }
+
+            .gallery-container { padding: 12px; }
+
+            .media-grid {
+                grid-template-columns: repeat(auto-fill, minmax(90px, 1fr)) !important;
+                gap: 6px !important;
+            }
+
+            .media-thumbnail {
+                height: 120px;
+            }
+
+            .list-view .media-thumbnail {
+                width: 35px;
+                height: 35px;
+            }
+
+            .media-info {
+                padding: 8px;
+            }
+
+            .media-name {
+                font-size: 0.8rem;
+            }
+
+            .media-details {
+                font-size: 0.7rem;
+            }
+
+            .stats-bar {
+                padding: 8px 16px;
+                font-size: 0.8rem;
+            }
+
+            .lightbox-content {
+                max-width: 95%;
+                max-height: 95%;
+            }
+
+            .close-btn {
+                top: 10px;
+                right: 20px;
+                font-size: 1.5rem;
+            }
+        }
+
+        @media (max-width: 480px) {
+            .header-bar {
+                padding: 10px 12px;
+            }
+
+            .search-bar {
+                padding: 5px 10px;
+                font-size: 13px;
+            }
+
+            .view-btn {
+                padding: 5px 6px;
+                font-size: 11px;
+            }
+
+            .gallery-container {
+                padding: 8px;
+            }
+
+            .media-grid {
+                grid-template-columns: repeat(auto-fill, minmax(75px, 1fr)) !important;
+                gap: 5px !important;
+            }
+
+            .media-thumbnail {
+                height: 100px;
+            }
+
+            .media-name {
+                font-size: 0.75rem;
+            }
+
+            .media-details {
+                font-size: 0.65rem;
+            }
+
+            .stats-bar {
+                padding: 6px 12px;
+                font-size: 0.75rem;
+            }
+
+            .tag {
+                padding: 3px 8px;
+                font-size: 0.7rem;
+            }
+
+            .sidebar-header {
+                padding: 16px;
+            }
+
+            .sidebar-title {
+                font-size: 1.1rem;
+            }
+
+            .sidebar-subtitle {
+                font-size: 0.8rem;
+            }
+        }
+
+        @media (max-width: 360px) {
+            .media-grid {
+                grid-template-columns: repeat(auto-fill, minmax(65px, 1fr)) !important;
+                gap: 4px !important;
+            }
+
+            .media-thumbnail {
+                height: 80px;
+            }
+
+            .view-btn {
+                padding: 4px 5px;
+                font-size: 10px;
+            }
+
+            .view-btn span {
+                display: none;
+            }
+        }
+
+        @media (max-width: 280px) {
+            .media-grid {
+                grid-template-columns: repeat(auto-fill, minmax(55px, 1fr)) !important;
+                gap: 3px !important;
+            }
+
+            .media-thumbnail {
+                height: 70px;
+            }
+
+            .gallery-container {
+                padding: 6px;
+            }
+        }
+
         /* ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒ¡ãƒ‹ãƒ¥ãƒ¼ */
         .context-menu {
             position: fixed;
@@ -758,6 +972,8 @@
         let currentFilter = 'all';
         let currentPath = '';
         let selectedFile = null;
+        const params = new URLSearchParams(location.search);
+        const selectMode = params.get('select') === '1';

         // APIãƒ™ãƒ¼ã‚¹URLã‚’å–å¾—
         let apiBaseUrl = '';
@@ -1236,7 +1452,22 @@
                 }

                 // å·¦ã‚¯ãƒªãƒƒã‚¯ã§ãƒ©ã‚¤ãƒˆãƒœãƒƒã‚¯ã‚¹ã‚’é–‹ã
-                item.addEventListener('click', () => openLightbox(file));
+                item.addEventListener('click', () => {
+                    if (selectMode) {
+                        // è¦ªãƒšãƒ¼ã‚¸ã¸é¸æŠçµæœã‚’é€šçŸ¥ï¼ˆ/images/ ç›¸å¯¾ãƒ‘ã‚¹ã«ãƒãƒƒãƒ— + ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰URLã‚‚æ·»ä»˜ï¼‰
+                        const rel = String(file.path || '').replace(/^\.?[\\/]+/, '').replace(/\\/g, '/');
+                        const payload = {
+                            type: 'media-selected',
+                            name: file.name,
+                            relative: rel,
+                            path: '/images/' + rel,
+                            url: apiBaseUrl ? (apiBaseUrl + '/' + rel) : ''
+                        };
+                        try { window.parent && window.parent.postMessage(payload, '*'); } catch(_){}
+                    } else {
+                        openLightbox(file);
+                    }
+                });

                 // å³ã‚¯ãƒªãƒƒã‚¯ã§ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’è¡¨ç¤º
                 item.addEventListener('contextmenu', (e) => {
@@ -1622,6 +1853,66 @@
             hideContextMenu();
         });

+        // ãƒ¢ãƒã‚¤ãƒ«ã‚µã‚¤ãƒ‰ãƒãƒ¼åˆ¶å¾¡
+        function initMobileSidebar() {
+            const sidebar = document.querySelector('.sidebar');
+            const headerBar = document.querySelector('.header-bar');
+
+            // ã‚µã‚¤ãƒ‰ãƒãƒ¼ãƒãƒƒã‚¯ãƒ‰ãƒ­ãƒƒãƒ—ã‚’ä½œæˆ
+            const backdrop = document.createElement('div');
+            backdrop.className = 'sidebar-backdrop';
+            document.body.appendChild(backdrop);
+
+            // ãƒ˜ãƒƒãƒ€ãƒ¼ãƒãƒ¼ã®ãƒãƒ³ãƒãƒ¼ã‚¬ãƒ¼ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆ
+            headerBar.addEventListener('click', (e) => {
+                if (e.target === headerBar || e.target.closest('.header-bar') === headerBar) {
+                    const rect = headerBar.getBoundingClientRect();
+                    if (e.clientX <= 50) { // å·¦ç«¯50pxã®ç¯„å›²ã§ã‚¯ãƒªãƒƒã‚¯ã—ãŸå ´åˆ
+                        toggleSidebar();
+                    }
+                }
+            });
+
+            // ãƒãƒƒã‚¯ãƒ‰ãƒ­ãƒƒãƒ—ã‚¯ãƒªãƒƒã‚¯ã§é–‰ã˜ã‚‹
+            backdrop.addEventListener('click', () => {
+                closeSidebar();
+            });
+
+            // ESCã‚­ãƒ¼ã§é–‰ã˜ã‚‹
+            document.addEventListener('keydown', (e) => {
+                if (e.key === 'Escape' && sidebar.classList.contains('open')) {
+                    closeSidebar();
+                }
+            });
+
+            function toggleSidebar() {
+                if (sidebar.classList.contains('open')) {
+                    closeSidebar();
+                } else {
+                    openSidebar();
+                }
+            }
+
+            function openSidebar() {
+                sidebar.classList.add('open');
+                backdrop.classList.add('show');
+                document.body.style.overflow = 'hidden';
+            }
+
+            function closeSidebar() {
+                sidebar.classList.remove('open');
+                backdrop.classList.remove('show');
+                document.body.style.overflow = '';
+            }
+
+            // ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚µã‚¤ã‚ºå¤‰æ›´æ™‚ã®å‡¦ç†
+            window.addEventListener('resize', () => {
+                if (window.innerWidth > 768) {
+                    closeSidebar();
+                }
+            });
+        }
+
         // åˆæœŸåŒ–
         function setupHtmlThumbs(root=document) {
             const IFR_W = 1024; // virtual viewport width (reduced for perf)
@@ -1696,6 +1987,14 @@

         document.addEventListener('DOMContentLoaded', () => {
             scanDirectory();
+            initMobileSidebar();
+            if (selectMode) {
+                // é¸æŠãƒ¢ãƒ¼ãƒ‰ã®ãƒ’ãƒ³ãƒˆã‚’è¡¨ç¤º
+                const bar = document.createElement('div');
+                bar.textContent = 'é¸æŠãƒ¢ãƒ¼ãƒ‰: ã‚¢ã‚¤ãƒ†ãƒ ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨è¦ªç”»é¢ã«é€ä¿¡ã•ã‚Œã¾ã™';
+                bar.style.cssText = 'position:sticky;top:0;left:0;right:0;background:#0a6cff;color:#fff;padding:8px 12px;font-weight:700;z-index:5;border-bottom:1px solid #084cb3';
+                document.querySelector('.gallery-container')?.prepend(bar);
+            }
         });
     </script>
 </body>
```


### å¤‰æ›´: `themes/kamui-docs/layouts/partials/header.html`

```diff
--- org-kamuios/themes/kamui-docs/layouts/partials/header.html	2025-09-23 10:32:56.635629781 +0000
+++ kamuios/themes/kamui-docs/layouts/partials/header.html	2025-09-23 10:32:52.531629828 +0000
@@ -10,19 +10,28 @@
   </button>

   <input type="text" class="search-bar" id="searchInput" placeholder="æ¤œç´¢..." />
-
-  <button id="backToDashboard" class="header-cta header-cta--muted header-cta--spacer" onclick="window.location.hash=''; location.reload();">
-    <span class="header-cta-icon" aria-hidden="true">â†</span>
-    <span class="header-cta-label">ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«æˆ»ã‚‹</span>
-  </button>

-  <button id="forceReloadBtn" class="header-cta header-cta--danger">
-    <span class="header-cta-icon" aria-hidden="true">â†»</span>
-    <span class="header-cta-label">å¼·åˆ¶ãƒªãƒ­ãƒ¼ãƒ‰</span>
-  </button>
+  <div class="header-actions">
+    <button id="backToDashboard"
+            class="header-action action-back"
+            aria-label="ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«æˆ»ã‚‹"
+            onclick="window.location.hash=''; location.reload();">
+      <span class="action-icon" aria-hidden="true">â†</span>
+      <span class="action-label">ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«æˆ»ã‚‹</span>
+    </button>

-  <button id="devToolsBtn" class="header-cta header-cta--primary">
-    <span class="header-cta-icon" aria-hidden="true">âš™</span>
-    <span class="header-cta-label">DevTools</span>
-  </button>
+    <button id="forceReloadBtn"
+            class="header-action action-reload"
+            aria-label="å¼·åˆ¶ãƒªãƒ­ãƒ¼ãƒ‰">
+      <span class="action-icon" aria-hidden="true">ğŸ”„</span>
+      <span class="action-label">å¼·åˆ¶ãƒªãƒ­ãƒ¼ãƒ‰</span>
+    </button>
+
+    <button id="devToolsBtn"
+            class="header-action action-devtools"
+            aria-label="DevTools ã‚’é–‹ã">
+      <span class="action-icon" aria-hidden="true">ğŸ› </span>
+      <span class="action-label">DevTools</span>
+    </button>
+  </div>
 </div>
```


### å¤‰æ›´: `themes/kamui-docs/static/css/main.css`

```diff
--- org-kamuios/themes/kamui-docs/static/css/main.css	2025-09-23 10:32:56.639629781 +0000
+++ kamuios/themes/kamui-docs/static/css/main.css	2025-09-23 10:32:52.539629828 +0000
@@ -131,7 +131,7 @@
 .header-cta-label { white-space: nowrap; }

 /* ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæœ¬æ–‡ */
-.doc-container { flex: 1; overflow-y: auto; overflow-x: auto !important; padding: 24px; }
+.doc-container { flex: 1; overflow-y: auto; overflow-x: hidden; padding: 24px; }
 /* Light mode: make the document area white */
 [data-theme="light"] .doc-container { background: #ffffff; }
 /* Light mode: keep code blocks readable even when inline styles set dark theme */
@@ -544,6 +544,11 @@
   .btn-label, .theme-label { display: none; }
   .menu-btn { padding: 8px; }
   .btn-icon { width: 20px; height: 20px; }
+
+  .header-actions { gap: 4px; }
+  .header-action { padding: 8px; gap: 0; min-width: 40px; justify-content: center; }
+  .header-action .action-label { display: none; }
+  .action-icon { font-size: 1.35rem; }

   /* ãƒ‡ã‚¶ã‚¤ãƒ³è¦ä»¶å®šç¾©ãƒ¢ãƒã‚¤ãƒ«å¯¾å¿œ */
   .color-swatches { grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 8px; }
@@ -2755,6 +2760,19 @@
   animation: pulse 1.5s ease-in-out infinite;
 }

+/* Responsive header actions from ERI */
+.header-actions { margin-left: auto; display: flex; align-items: center; gap: 8px; }
+.header-action { display: inline-flex; align-items: center; gap: 6px; padding: 8px 14px; border: none; border-radius: 6px; font-size: 0.9rem; line-height: 1; color: #fff; cursor: pointer; transition: background-color 0.2s ease, transform 0.2s ease; }
+.header-action:active { transform: translateY(1px); }
+.action-back { background: #4a4a4a; }
+.action-back:hover { background: #5a5a5a; }
+.action-reload { background: #dc2626; }
+.action-reload:hover { background: #ef4444; }
+.action-devtools { background: #3b82f6; }
+.action-devtools:hover { background: #2563eb; }
+.action-icon { font-size: 1.1rem; line-height: 1; display: inline-flex; align-items: center; justify-content: center; width: 1em; }
+.action-label { display: inline-block; white-space: nowrap; }
+
 @keyframes pulse {
   0%, 100% { opacity: 0.8; transform: scale(1); }
   50% { opacity: 1; transform: scale(1.1); }
```


### å¤‰æ›´: `backend/tasks-state.json`

```diff
--- org-kamuios/backend/tasks-state.json	2025-09-23 10:32:52.547629827 +0000
+++ kamuios/backend/tasks-state.json	2025-09-23 10:32:50.259629853 +0000
@@ -1,7 +1,7 @@
 {
   "version": 2,
-  "savedAt": "2025-09-22T09:27:46.374Z",
-  "nextTaskId": 2,
+  "savedAt": "2025-09-22T12:55:26.441Z",
+  "nextTaskId": 3,
   "tasks": [
     {
       "id": "1",
@@ -45,6 +45,56 @@
       "stderr": "",
       "stdoutBytes": 476,
       "stderrBytes": 0,
+      "manualDone": false,
+      "completionSummary": "",
+      "completionSummaryPending": false,
+      "codexPollingDisabled": false,
+      "codexIdleChecks": 0,
+      "codexHasSeenWorking": false,
+      "externalTerminal": null
+    },
+    {
+      "id": "2",
+      "status": "completed",
+      "prompt": "hi",
+      "command": "codex exec --json --sandbox danger-full-access hi",
+      "createdAt": "2025-09-22T12:55:20.347Z",
+      "updatedAt": "2025-09-22T12:55:26.440Z",
+      "endedAt": "2025-09-22T12:55:26.440Z",
+      "exitCode": 0,
+      "urls": [
+        "https://openai.com/chatgpt/pricing"
+      ],
+      "files": [
+        "/openai.com"
+      ],
+      "lastActivityAt": "2025-09-22T12:55:26.410Z",
+      "durationMs": 6093,
+      "provider": "codex",
+      "model": null,
+      "type": "codex_exec",
+      "importance": "medium",
+      "urgency": "medium",
+      "resultText": "",
+      "resultMeta": {
+        "provider": "codex",
+        "model": null,
+        "profile": null,
+        "sandbox": "danger-full-access",
+        "token_usage": null,
+        "errors": [
+          "You've hit your usage limit. Upgrade to Pro (https://openai.com/chatgpt/pricing) or try again in 2 days 10 hours 19 minutes."
+        ],
+        "exit_code": 0
+      },
+      "logs": [
+        "[CODEX] Task started\n",
+        "[CODEX ERROR] You've hit your usage limit. Upgrade to Pro (https://openai.com/chatgpt/pricing) or try again in 2 days 10 hours 19 minutes.\n"
+      ],
+      "stdout": "{\"sandbox\":\"danger-full-access\",\"reasoning effort\":\"high\",\"workdir\":\"/data/data/com.termux/files/home/kamuios/kamuios/backend\",\"model\":\"gpt-5-codex\",\"provider\":\"openai\",\"approval\":\"never\",\"reasoning summaries\":\"auto\"}\n{\"prompt\":\"hi\"}\n{\"id\":\"0\",\"msg\":{\"type\":\"task_started\",\"model_context_window\":272000}}\n{\"id\":\"0\",\"msg\":{\"type\":\"error\",\"message\":\"You've hit your usage limit. Upgrade to Pro (https://openai.com/chatgpt/pricing) or try again in 2 days 10 hours 19 minutes.\"}}\n",
+      "stderr": "",
+      "stdoutBytes": 476,
+      "stderrBytes": 0,
       "manualDone": false,
       "completionSummary": "",
       "completionSummaryPending": false,
```


### å‰Šé™¤: `uploaded_cards.txt`

ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯ `kamuios` ã§å‰Šé™¤ã•ã‚Œã¾ã—ãŸã€‚
